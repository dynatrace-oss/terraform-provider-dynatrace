---
layout: ""
page_title: dynatrace_host_anomalies_v2 Resource - terraform-provider-dynatrace"
subcategory: "Anomaly Detection"
description: |-
  The resource `dynatrace_host_anomalies_v2` covers configuration for host anomaly detection
---

# dynatrace_host_anomalies_v2 (Resource)

-> This resource requires the API token scopes **Read settings** (`settings.read`) and **Write settings** (`settings.write`)

## Dynatrace Documentation

- Adjust the sensitivity of anomaly detection for infrastructure - https://www.dynatrace.com/support/help/how-to-use-dynatrace/problem-detection-and-analysis/problem-detection/adjust-sensitivity-anomaly-detection/adjust-sensitivity-infastructure

- Settings API - https://www.dynatrace.com/support/help/dynatrace-api/environment-api/settings (schemaId: `builtin:anomaly-detection.infrastructure-hosts`)

## Export Example Usage

- `terraform-provider-dynatrace -export dynatrace_host_anomalies_v2` downloads all existing host anomaly detection configuration

The full documentation of the export feature is available [here](https://dt-url.net/h203qmc).

## Resource Example Usage

```terraform
resource "dynatrace_host_anomalies_v2" "#name#" {
  scope = "HOST-1234567890000000"
  host {
    connection_lost_detection {
      enabled               = true
      on_graceful_shutdowns = "DONT_ALERT_ON_GRACEFUL_SHUTDOWN"
    }
    high_cpu_saturation_detection {
      enabled        = true
      detection_mode = "custom"
      custom_thresholds {
        cpu_saturation = 95
        event_thresholds {
          dealerting_evaluation_window = 30
          dealerting_samples           = 30
          violating_evaluation_window  = 30
          violating_samples            = 18
        }
      }
    }
    high_gc_activity_detection {
      enabled        = true
      detection_mode = "custom"
      custom_thresholds {
        gc_suspension_percentage = 25
        gc_time_percentage       = 40
        event_thresholds {
          dealerting_evaluation_window = 30
          dealerting_samples           = 30
          violating_evaluation_window  = 30
          violating_samples            = 18
        }
      }
    }
    high_memory_detection {
      enabled        = true
      detection_mode = "auto"
    }
    high_system_load_detection {
      enabled        = true
      detection_mode = "custom"
      custom_thresholds {
        system_load = 1
        event_thresholds {
          dealerting_evaluation_window = 30
          dealerting_samples           = 30
          violating_evaluation_window  = 6
          violating_samples            = 1
        }
      }
    }
    out_of_memory_detection {
      enabled        = true
      detection_mode = "custom"
      custom_thresholds {
        out_of_memory_exceptions_number = 1
        event_thresholds {
          dealerting_evaluation_window = 30
          dealerting_samples           = 30
          violating_evaluation_window  = 6
          violating_samples            = 1
        }
      }
    }
    out_of_threads_detection {
      enabled        = true
      detection_mode = "custom"
      custom_thresholds {
        out_of_threads_exceptions_number = 1
        event_thresholds {
          dealerting_evaluation_window = 30
          dealerting_samples           = 30
          violating_evaluation_window  = 6
          violating_samples            = 1
        }
      }
    }
  }
  network {
    high_network_detection {
      enabled        = true
      detection_mode = "custom"
      custom_thresholds {
        errors_percentage = 90
        event_thresholds {
          dealerting_evaluation_window = 30
          dealerting_samples           = 30
          violating_evaluation_window  = 30
          violating_samples            = 18
        }
      }
    }
    network_dropped_packets_detection {
      enabled        = true
      detection_mode = "auto"
    }
    network_errors_detection {
      enabled        = true
      detection_mode = "auto"
    }
    network_high_retransmission_detection {
      enabled        = true
      detection_mode = "custom"
      custom_thresholds {
        retransmission_rate_percentage          = 10
        retransmitted_packets_number_per_minute = 10
        event_thresholds {
          dealerting_evaluation_window = 30
          dealerting_samples           = 30
          violating_evaluation_window  = 30
          violating_samples            = 18
        }
      }
    }
    network_tcp_problems_detection {
      enabled        = true
      detection_mode = "auto"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `host` (Block List, Min: 1, Max: 1) Hosts (see [below for nested schema](#nestedblock--host))
- `network` (Block List, Min: 1, Max: 1) Network (see [below for nested schema](#nestedblock--network))
- `scope` (String) The scope of this setting (HOST HOST_GROUP environment)

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--host"></a>
### Nested Schema for `host`

Required:

- `connection_lost_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--connection_lost_detection))
- `high_cpu_saturation_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_cpu_saturation_detection))
- `high_gc_activity_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_gc_activity_detection))
- `high_memory_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_memory_detection))
- `high_system_load_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_system_load_detection))
- `out_of_memory_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--out_of_memory_detection))
- `out_of_threads_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--out_of_threads_detection))

<a id="nestedblock--host--connection_lost_detection"></a>
### Nested Schema for `host.connection_lost_detection`

Required:

- `enabled` (Boolean) Detect host or monitoring connection lost problems

Optional:

- `on_graceful_shutdowns` (String) Graceful host shutdowns. Possible values: `DONT_ALERT_ON_GRACEFUL_SHUTDOWN`, `ALERT_ON_GRACEFUL_SHUTDOWN`


<a id="nestedblock--host--high_cpu_saturation_detection"></a>
### Nested Schema for `host.high_cpu_saturation_detection`

Required:

- `enabled` (Boolean) Detect CPU saturation on host

Optional:

- `custom_thresholds` (Block List, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_cpu_saturation_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for CPU saturation

<a id="nestedblock--host--high_cpu_saturation_detection--custom_thresholds"></a>
### Nested Schema for `host.high_cpu_saturation_detection.custom_thresholds`

Required:

- `cpu_saturation` (Number) Alert if the CPU usage is higher than this threshold for the defined amount of samples
- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_cpu_saturation_detection--custom_thresholds--event_thresholds))

<a id="nestedblock--host--high_cpu_saturation_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `host.high_cpu_saturation_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--host--high_gc_activity_detection"></a>
### Nested Schema for `host.high_gc_activity_detection`

Required:

- `enabled` (Boolean) You may also configure high GC activity alerting for .NET processes on [extensions events page](/#settings/anomalydetection/extensionevents).

Optional:

- `custom_thresholds` (Block List, Max: 1) Alert if the GC time **or** the GC suspension is exceeded (see [below for nested schema](#nestedblock--host--high_gc_activity_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for high GC activity

<a id="nestedblock--host--high_gc_activity_detection--custom_thresholds"></a>
### Nested Schema for `host.high_gc_activity_detection.custom_thresholds`

Required:

- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_gc_activity_detection--custom_thresholds--event_thresholds))
- `gc_suspension_percentage` (Number) Alert if the GC suspension is higher than this threshold
- `gc_time_percentage` (Number) Alert if GC time is higher than this threshold

<a id="nestedblock--host--high_gc_activity_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `host.high_gc_activity_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--host--high_memory_detection"></a>
### Nested Schema for `host.high_memory_detection`

Required:

- `enabled` (Boolean) Detect high memory usage on host

Optional:

- `custom_thresholds` (Block List, Max: 1) Alert if **both** the memory usage and the memory page fault rate thresholds are exceeded on Windows or on Unix systems (see [below for nested schema](#nestedblock--host--high_memory_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for high memory usage

<a id="nestedblock--host--high_memory_detection--custom_thresholds"></a>
### Nested Schema for `host.high_memory_detection.custom_thresholds`

Required:

- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_memory_detection--custom_thresholds--event_thresholds))
- `page_faults_per_second_non_windows` (Number) Alert if the memory page fault rate on Unix systems is higher than this threshold for the defined amount of samples
- `page_faults_per_second_windows` (Number) Alert if the memory page fault rate on Windows is higher than this threshold for the defined amount of samples
- `used_memory_percentage_non_windows` (Number) Alert if the memory usage on Unix systems is higher than this threshold
- `used_memory_percentage_windows` (Number) Alert if the memory usage on Windows is higher than this threshold

<a id="nestedblock--host--high_memory_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `host.high_memory_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--host--high_system_load_detection"></a>
### Nested Schema for `host.high_system_load_detection`

Required:

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)

Optional:

- `custom_thresholds` (Block List, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_system_load_detection--custom_thresholds))
- `detection_mode` (String) Possible Values: `Auto`, `Custom`

<a id="nestedblock--host--high_system_load_detection--custom_thresholds"></a>
### Nested Schema for `host.high_system_load_detection.custom_thresholds`

Required:

- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--high_system_load_detection--custom_thresholds--event_thresholds))
- `system_load` (Number) Alert if the System Load / Logical cpu core is higher than this threshold for the defined amount of samples

<a id="nestedblock--host--high_system_load_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `host.high_system_load_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--host--out_of_memory_detection"></a>
### Nested Schema for `host.out_of_memory_detection`

Required:

- `enabled` (Boolean) Detect Java out of memory problem

Optional:

- `custom_thresholds` (Block List, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--out_of_memory_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for Java out of memory problem

<a id="nestedblock--host--out_of_memory_detection--custom_thresholds"></a>
### Nested Schema for `host.out_of_memory_detection.custom_thresholds`

Required:

- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--out_of_memory_detection--custom_thresholds--event_thresholds))
- `out_of_memory_exceptions_number` (Number) Alert if the number of Java out-of-memory exceptions is at least this value

<a id="nestedblock--host--out_of_memory_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `host.out_of_memory_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--host--out_of_threads_detection"></a>
### Nested Schema for `host.out_of_threads_detection`

Required:

- `enabled` (Boolean) Detect Java out of threads problem

Optional:

- `custom_thresholds` (Block List, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--out_of_threads_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for Java out of threads problem

<a id="nestedblock--host--out_of_threads_detection--custom_thresholds"></a>
### Nested Schema for `host.out_of_threads_detection.custom_thresholds`

Required:

- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--host--out_of_threads_detection--custom_thresholds--event_thresholds))
- `out_of_threads_exceptions_number` (Number) Alert if the number of Java out-of-threads exceptions is at least this value

<a id="nestedblock--host--out_of_threads_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `host.out_of_threads_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event





<a id="nestedblock--network"></a>
### Nested Schema for `network`

Required:

- `high_network_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--high_network_detection))
- `network_dropped_packets_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_dropped_packets_detection))
- `network_errors_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_errors_detection))
- `network_high_retransmission_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_high_retransmission_detection))
- `network_tcp_problems_detection` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_tcp_problems_detection))

<a id="nestedblock--network--high_network_detection"></a>
### Nested Schema for `network.high_network_detection`

Required:

- `enabled` (Boolean) Detect high network utilization

Optional:

- `custom_thresholds` (Block List, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--high_network_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for high network utilization

<a id="nestedblock--network--high_network_detection--custom_thresholds"></a>
### Nested Schema for `network.high_network_detection.custom_thresholds`

Required:

- `errors_percentage` (Number) Alert if sent/received traffic utilization is higher than this threshold for the defined amount of samples
- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--high_network_detection--custom_thresholds--event_thresholds))

<a id="nestedblock--network--high_network_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `network.high_network_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--network--network_dropped_packets_detection"></a>
### Nested Schema for `network.network_dropped_packets_detection`

Required:

- `enabled` (Boolean) Detect high number of dropped packets

Optional:

- `custom_thresholds` (Block List, Max: 1) Alert if the dropped packet percentage is higher than the specified threshold **and** the total packets rate is higher than the defined threshold for the defined amount of samples (see [below for nested schema](#nestedblock--network--network_dropped_packets_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for high number of dropped packets

<a id="nestedblock--network--network_dropped_packets_detection--custom_thresholds"></a>
### Nested Schema for `network.network_dropped_packets_detection.custom_thresholds`

Required:

- `dropped_packets_percentage` (Number) Receive/transmit dropped packet percentage threshold
- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_dropped_packets_detection--custom_thresholds--event_thresholds))
- `total_packets_rate` (Number) Total packets rate threshold

<a id="nestedblock--network--network_dropped_packets_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `network.network_dropped_packets_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--network--network_errors_detection"></a>
### Nested Schema for `network.network_errors_detection`

Required:

- `enabled` (Boolean) Detect high number of network errors

Optional:

- `custom_thresholds` (Block List, Max: 1) Alert if the receive/transmit error packet percentage is higher than the specified threshold **and** the total packets rate is higher than the defined threshold for the defined amount of samples (see [below for nested schema](#nestedblock--network--network_errors_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for high number of network errors

<a id="nestedblock--network--network_errors_detection--custom_thresholds"></a>
### Nested Schema for `network.network_errors_detection.custom_thresholds`

Required:

- `errors_percentage` (Number) Receive/transmit error packet percentage threshold
- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_errors_detection--custom_thresholds--event_thresholds))
- `total_packets_rate` (Number) Total packets rate threshold

<a id="nestedblock--network--network_errors_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `network.network_errors_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--network--network_high_retransmission_detection"></a>
### Nested Schema for `network.network_high_retransmission_detection`

Required:

- `enabled` (Boolean) Detect high retransmission rate

Optional:

- `custom_thresholds` (Block List, Max: 1) Alert if the retransmission rate is higher than the specified threshold **and** the number of retransmitted packets is higher than the defined threshold for the defined amount of samples (see [below for nested schema](#nestedblock--network--network_high_retransmission_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for high retransmission rate

<a id="nestedblock--network--network_high_retransmission_detection--custom_thresholds"></a>
### Nested Schema for `network.network_high_retransmission_detection.custom_thresholds`

Required:

- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_high_retransmission_detection--custom_thresholds--event_thresholds))
- `retransmission_rate_percentage` (Number) Retransmission rate threshold
- `retransmitted_packets_number_per_minute` (Number) Number of retransmitted packets threshold

<a id="nestedblock--network--network_high_retransmission_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `network.network_high_retransmission_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event




<a id="nestedblock--network--network_tcp_problems_detection"></a>
### Nested Schema for `network.network_tcp_problems_detection`

Required:

- `enabled` (Boolean) Detect TCP connectivity problems for process

Optional:

- `custom_thresholds` (Block List, Max: 1) Alert if the percentage of new connection failures is higher than the specified threshold **and** the number of failed connections is higher than the defined threshold for the defined amount of samples (see [below for nested schema](#nestedblock--network--network_tcp_problems_detection--custom_thresholds))
- `detection_mode` (String) Detection mode for TCP connectivity problems

<a id="nestedblock--network--network_tcp_problems_detection--custom_thresholds"></a>
### Nested Schema for `network.network_tcp_problems_detection.custom_thresholds`

Required:

- `event_thresholds` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--network--network_tcp_problems_detection--custom_thresholds--event_thresholds))
- `failed_connections_number_per_minute` (Number) Number of failed connections threshold
- `new_connection_failures_percentage` (Number) New connection failure threshold

<a id="nestedblock--network--network_tcp_problems_detection--custom_thresholds--event_thresholds"></a>
### Nested Schema for `network.network_tcp_problems_detection.custom_thresholds.event_thresholds`

Required:

- `dealerting_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window for dealerting.
- `dealerting_samples` (Number) The number of **10-second samples** within the evaluation window that must be lower the threshold to close an event
- `violating_evaluation_window` (Number) The number of **10-second samples** that form the sliding evaluation window to detect violating samples.
- `violating_samples` (Number) The number of **10-second samples** within the evaluation window that must exceed the threshold to trigger an event
 