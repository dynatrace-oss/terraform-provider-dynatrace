---
layout: ""
page_title:  Resource - terraform-provider-dynatrace"
subcategory: "Application Security"
description: |-
  The resource `dynatrace_vulnerability_third_party_k8s` covers configuration for vulnerability analytics: Kubernetes monitoring rules for third-party vulnerabilities
---

# dynatrace_vulnerability_third_party_k8s (Resource)

-> This resource requires the API token scopes **Read security problems** (`securityProblems.read`) and **Write security problems** (`securityProblems.write`)

-> This resource is excluded by default in the export utility, please explicitly specify the resource to retrieve existing configuration.

## Dynatrace Documentation

- Runtime Vulnerability Analytics - https://www.dynatrace.com/support/help/platform-modules/application-security/vulnerability-analytics

- Settings API - https://www.dynatrace.com/support/help/dynatrace-api/environment-api/settings (schemaId: `builtin:appsec.third-party-vulnerability-kubernetes-label-rule-settings`)

## Resource Example Usage

```terraform
resource "dynatrace_vulnerability_third_party_k8s" "#name#" {
  enabled      = false
  rule_name    = "#name#"
  kubernetes_label_conditions {
    kubernetes_label_condition {
      kubernetes_label_key   = "kubernetes.azure.com/mode"
      kubernetes_label_value = "#name#"
      matcher                = "NOT_EQUALS"
    }
    kubernetes_label_condition {
      kubernetes_label_key   = "agentpool"
      kubernetes_label_value = "#name#"
      matcher                = "CONTAINS"
    }
  }
  metadata {
    comment = "#name#"
  }
  vulnerability_detection_control {
    monitoring_mode = "MONITORING_OFF"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)
- `metadata` (Block List, Min: 1, Max: 1) Step 3: Leave comment (optional) (see [below for nested schema](#nestedblock--metadata))
- `vulnerability_detection_control` (Block List, Min: 1, Max: 1) Step 1: Select third-party vulnerability detection behavior (see [below for nested schema](#nestedblock--vulnerability_detection_control))

### Optional

- `insert_after` (String) Because this resource allows for ordering you may specify the ID of the resource instance that comes before this instance regarding order. If not specified when creating the setting will be added to the end of the list. If not specified during update the order will remain untouched
- `kubernetes_label_conditions` (Block List, Max: 1) When you add multiple conditions, the rule applies if all conditions apply.

If you want the rule to apply only to a subset of your environment, provide the Kubernetes label that should be used to identify that part of the environment. (see [below for nested schema](#nestedblock--kubernetes_label_conditions))
- `rule_name` (String) Rule name

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

Required:

- `comment` (String) no documentation available


<a id="nestedblock--vulnerability_detection_control"></a>
### Nested Schema for `vulnerability_detection_control`

Required:

- `monitoring_mode` (String) Possible Values: `MONITORING_OFF`, `MONITORING_ON`


<a id="nestedblock--kubernetes_label_conditions"></a>
### Nested Schema for `kubernetes_label_conditions`

Required:

- `kubernetes_label_condition` (Block List, Min: 1) (see [below for nested schema](#nestedblock--kubernetes_label_conditions--kubernetes_label_condition))

<a id="nestedblock--kubernetes_label_conditions--kubernetes_label_condition"></a>
### Nested Schema for `kubernetes_label_conditions.kubernetes_label_condition`

Required:

- `kubernetes_label_key` (String) Kubernetes label key
- `matcher` (String) Possible Values: `CONTAINS`, `DOES_NOT_CONTAIN`, `DOES_NOT_END_WITH`, `DOES_NOT_EXIST`, `DOES_NOT_START_WITH`, `ENDS_WITH`, `EQUALS`, `EXISTS`, `NOT_EQUALS`, `STARTS_WITH`

Optional:

- `kubernetes_label_value` (String) Kubernetes label value
