---
layout: ""
page_title:  Resource - terraform-provider-dynatrace"
subcategory: "Service Detection"
description: |-
  The resource `dynatrace_endpoint_detection_rules` covers configuration for endpoint detection rules
---

# dynatrace_endpoint_detection_rules (Resource)

-> This resource requires the API token scopes **Read settings** (`settings.read`) and **Write settings** (`settings.write`)

## Dynatrace Documentation

- Customize endpoint detection in Service Detection v2 - https://docs.dynatrace.com/docs/observe/applications-and-microservices/services/service-detection-v2/endpoint-detection-v2

- Settings API - https://www.dynatrace.com/support/help/dynatrace-api/environment-api/settings (schemaId: `builtin:endpoint-detection-rules`)

## Resource Example Usage

```terraform
resource "dynatrace_endpoint_detection_rules" "first-instance" {
  enabled      = true
  scope        = "environment"
  rule {
    description            = "This is a sample description"
    condition              = "matchesValue(k8s.cluster.name,\"#name#-1\")"
    endpoint_name_template = "#name#"
    if_condition_matches   = "DETECT_REQUEST_ON_ENDPOINT"
    rule_name              = "#name#-1"
  }
}

resource "dynatrace_endpoint_detection_rules" "second-instance" {
  insert_after = dynatrace_endpoint_detection_rules.first-instance.id
  enabled      = false
  scope        = "environment"
  rule {
    condition            = "matchesValue(k8s.cluster.name,\"#name#-2\")"
    if_condition_matches = "SUPPRESS_REQUEST"
    rule_name            = "#name#-2"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)
- `rule` (Block List, Min: 1, Max: 1) Rule (see [below for nested schema](#nestedblock--rule))

### Optional

- `insert_after` (String) Because this resource allows for ordering you may specify the ID of the resource instance that comes before this instance regarding order. If not specified when creating the setting will be added to the end of the list. If not specified during update the order will remain untouched
- `scope` (String) The scope of this setting (CLOUD_APPLICATION_NAMESPACE, KUBERNETES_CLUSTER, HOST_GROUP). Omit this property if you want to cover the whole environment.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--rule"></a>
### Nested Schema for `rule`

Required:

- `if_condition_matches` (String) Possible Values: `DETECT_REQUEST_ON_ENDPOINT`, `SUPPRESS_REQUEST`
- `rule_name` (String) Rule name

Optional:

- `condition` (String) Limits the scope of the endpoint detection rule using [DQL matcher](https://dt-url.net/l603wby) conditions on span and resource attributes.. A rule is applied only if the condition matches, otherwise the ruleset evaluation continues.

If empty, the condition will always match.
- `description` (String) no documentation available
- `endpoint_name_template` (String) Specify attribute placeholders in curly braces, e.g. {http.route} or {rpc.method}.. Attribute value placeholders should be specified in curly braces, e.g. {http.route}, {rpc.method}. All attributes used in the placeholder are required for the rule to apply. If any of them is missing, the rule will not be applied and ruleset evaluation continues.

If the resolved endpoint name on a given span is empty, the request will be ignored.
