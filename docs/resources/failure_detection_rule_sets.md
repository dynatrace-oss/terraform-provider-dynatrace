---
layout: ""
page_title:  Resource - terraform-provider-dynatrace"
subcategory: "Service Detection"
description: |-
  The resource `dynatrace_failure_detection_rule_sets` covers configuration for failure detection rule sets
---

# dynatrace_failure_detection_rule_sets (Resource)

-> This resource requires the API token scopes **Read settings** (`settings.read`) and **Write settings** (`settings.write`)

## Dynatrace Documentation

- Customize failure detection in Service Detection v2 - https://docs.dynatrace.com/docs/observe/applications-and-microservices/services/service-detection-v2/failure-detection-v2

- Settings API - https://www.dynatrace.com/support/help/dynatrace-api/environment-api/settings (schemaId: `builtin:failure-detection-rulesets`)

## Resource Example Usage

```terraform
resource "dynatrace_failure_detection_rule_sets" "#name#" {
  enabled = false
  scope   = "environment"
  ruleset {
    description  = "This is a sample description"
    condition    = "matchesValue(k8s.cluster.name,\"#name#\")"
    ruleset_name = "#name#"
    fail_on_exceptions {
      enabled = true
    }
    fail_on_grpc_status_codes {
      status_codes = "2,4,12,13,14,15"
    }
    fail_on_http_response_status_codes {
      status_codes = "500-599"
    }
    fail_on_span_status_error {
      enabled = true
    }
    overrides {
      force_success_on_span_status_ok {
        enabled = false
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)
- `ruleset` (Block List, Min: 1, Max: 1) Ruleset (see [below for nested schema](#nestedblock--ruleset))

### Optional

- `insert_after` (String) Because this resource allows for ordering you may specify the ID of the resource instance that comes before this instance regarding order. If not specified when creating the setting will be added to the end of the list. If not specified during update the order will remain untouched
- `scope` (String) The scope of this setting (CLOUD_APPLICATION_NAMESPACE, KUBERNETES_CLUSTER, HOST_GROUP). Omit this property if you want to cover the whole environment.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--ruleset"></a>
### Nested Schema for `ruleset`

Required:

- `fail_on_exceptions` (Block List, Min: 1, Max: 1) Evaluated expression: `iAny(`span.events`[][`span_event.name`] == "exception" and `span.events`[][`exception.escaped`] != false)`

Failure detection result: `reason="exception"`, `verdict="failure"`, `exception_ids` (see [below for nested schema](#nestedblock--ruleset--fail_on_exceptions))
- `fail_on_grpc_status_codes` (Block List, Min: 1, Max: 1) Evaluated attribute: `rpc.grpc.status_code`

Failure detection result: `reason="grpc_code"`, `verdict="failure"` (see [below for nested schema](#nestedblock--ruleset--fail_on_grpc_status_codes))
- `fail_on_http_response_status_codes` (Block List, Min: 1, Max: 1) Evaluated attribute: `http.response.status_code`

Failure detection result: `reason="http_code"`, `verdict="failure"` (see [below for nested schema](#nestedblock--ruleset--fail_on_http_response_status_codes))
- `fail_on_span_status_error` (Block List, Min: 1, Max: 1) Evaluated attribute: `span.status_code`

Failure detection result: `reason="span_status"`, `verdict="failure"` (see [below for nested schema](#nestedblock--ruleset--fail_on_span_status_error))
- `overrides` (Block List, Min: 1, Max: 1) no documentation available (see [below for nested schema](#nestedblock--ruleset--overrides))
- `ruleset_name` (String) Ruleset name

Optional:

- `condition` (String) Limits the scope of the failure detection ruleset using [DQL matcher](https://dt-url.net/l603wby) conditions on span and resource attributes.. A ruleset is applied only if the condition matches, otherwise the evaluation continues.

If empty, the condition will always match.
- `description` (String) no documentation available
- `fail_on_custom_rules` (Block List, Max: 1) Define failure reasons based on span and request attributes.. Failure detection result: `reason="custom_rule"`, `verdict="failure"`, `custom_rule_name` (see [below for nested schema](#nestedblock--ruleset--fail_on_custom_rules))

<a id="nestedblock--ruleset--fail_on_exceptions"></a>
### Nested Schema for `ruleset.fail_on_exceptions`

Required:

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)

Optional:

- `ignored_exceptions` (Block List, Max: 1) no documentation available (see [below for nested schema](#nestedblock--ruleset--fail_on_exceptions--ignored_exceptions))

<a id="nestedblock--ruleset--fail_on_exceptions--ignored_exceptions"></a>
### Nested Schema for `ruleset.fail_on_exceptions.ignored_exceptions`

Required:

- `ignored_exception` (Block Set, Min: 1) (see [below for nested schema](#nestedblock--ruleset--fail_on_exceptions--ignored_exceptions--ignored_exception))

<a id="nestedblock--ruleset--fail_on_exceptions--ignored_exceptions--ignored_exception"></a>
### Nested Schema for `ruleset.fail_on_exceptions.ignored_exceptions.ignored_exception`

Required:

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)

Optional:

- `message` (String) Evaluated attribute: `span.events[][exception.message]`
- `type` (String) Evaluated attribute: `span.events[][exception.type]`




<a id="nestedblock--ruleset--fail_on_grpc_status_codes"></a>
### Nested Schema for `ruleset.fail_on_grpc_status_codes`

Required:

- `status_codes` (String) Status codes which indicate a failure on the server side


<a id="nestedblock--ruleset--fail_on_http_response_status_codes"></a>
### Nested Schema for `ruleset.fail_on_http_response_status_codes`

Required:

- `status_codes` (String) Status codes which indicate a failure on the server side


<a id="nestedblock--ruleset--fail_on_span_status_error"></a>
### Nested Schema for `ruleset.fail_on_span_status_error`

Required:

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)


<a id="nestedblock--ruleset--overrides"></a>
### Nested Schema for `ruleset.overrides`

Required:

- `force_success_on_span_status_ok` (Block List, Min: 1, Max: 1) Evaluated attribute: `span.status_code`

Failure detection result: `reason="span_status"`, `verdict="success"` (see [below for nested schema](#nestedblock--ruleset--overrides--force_success_on_span_status_ok))

Optional:

- `force_success_on_exceptions` (Block List, Max: 1) Define escaped exceptions that should force success.. Evaluated expression: `iAny(`span.events`[][`span_event.name`] == "exception" and `span.events`[][`exception.escaped`] != false)`

Failure detection result: `reason="exception"`, `verdict="success"`, `exception_ids` (see [below for nested schema](#nestedblock--ruleset--overrides--force_success_on_exceptions))
- `force_success_on_grpc_response_status_codes` (Block List, Max: 1) Evaluated attribute: `rpc.grpc.status_code`

Failure detection result: `reason="grpc_code"`, `verdict="success"` (see [below for nested schema](#nestedblock--ruleset--overrides--force_success_on_grpc_response_status_codes))
- `force_success_on_http_response_status_codes` (Block List, Max: 1) Evaluated attribute: `http.response.status_code`

Failure detection result: `reason="http_code"`, `verdict="success"` (see [below for nested schema](#nestedblock--ruleset--overrides--force_success_on_http_response_status_codes))
- `force_success_with_custom_rules` (Block List, Max: 1) Override failures based on span and request attribute conditions.. Failure detection result: `reason="custom_rule"`, `verdict="success"`, `custom_rule_name` (see [below for nested schema](#nestedblock--ruleset--overrides--force_success_with_custom_rules))

<a id="nestedblock--ruleset--overrides--force_success_on_span_status_ok"></a>
### Nested Schema for `ruleset.overrides.force_success_on_span_status_ok`

Required:

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)


<a id="nestedblock--ruleset--overrides--force_success_on_exceptions"></a>
### Nested Schema for `ruleset.overrides.force_success_on_exceptions`

Required:

- `ignored_exception` (Block Set, Min: 1) (see [below for nested schema](#nestedblock--ruleset--overrides--force_success_on_exceptions--ignored_exception))

<a id="nestedblock--ruleset--overrides--force_success_on_exceptions--ignored_exception"></a>
### Nested Schema for `ruleset.overrides.force_success_on_exceptions.ignored_exception`

Required:

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)

Optional:

- `message` (String) Evaluated attribute: `span.events[][exception.message]`
- `type` (String) Evaluated attribute: `span.events[][exception.type]`



<a id="nestedblock--ruleset--overrides--force_success_on_grpc_response_status_codes"></a>
### Nested Schema for `ruleset.overrides.force_success_on_grpc_response_status_codes`

Optional:

- `status_codes` (String) Status codes which force success on the server side


<a id="nestedblock--ruleset--overrides--force_success_on_http_response_status_codes"></a>
### Nested Schema for `ruleset.overrides.force_success_on_http_response_status_codes`

Optional:

- `status_codes` (String) Status codes which force success on the server side


<a id="nestedblock--ruleset--overrides--force_success_with_custom_rules"></a>
### Nested Schema for `ruleset.overrides.force_success_with_custom_rules`

Required:

- `fail_on_custom_rule` (Block Set, Min: 1) (see [below for nested schema](#nestedblock--ruleset--overrides--force_success_with_custom_rules--fail_on_custom_rule))

<a id="nestedblock--ruleset--overrides--force_success_with_custom_rules--fail_on_custom_rule"></a>
### Nested Schema for `ruleset.overrides.force_success_with_custom_rules.fail_on_custom_rule`

Required:

- `dql_condition` (String) Custom rule based on span attributes using [DQL matcher](https://dt-url.net/l603wby).
- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)
- `rule_name` (String) Rule name




<a id="nestedblock--ruleset--fail_on_custom_rules"></a>
### Nested Schema for `ruleset.fail_on_custom_rules`

Required:

- `fail_on_custom_rule` (Block Set, Min: 1) (see [below for nested schema](#nestedblock--ruleset--fail_on_custom_rules--fail_on_custom_rule))

<a id="nestedblock--ruleset--fail_on_custom_rules--fail_on_custom_rule"></a>
### Nested Schema for `ruleset.fail_on_custom_rules.fail_on_custom_rule`

Required:

- `dql_condition` (String) Custom rule based on span attributes using [DQL matcher](https://dt-url.net/l603wby).
- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)
- `rule_name` (String) Rule name
