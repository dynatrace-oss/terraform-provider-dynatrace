---
layout: ""
page_title: dynatrace_vulnerability_code Resource - terraform-provider-dynatrace"
subcategory: "Application Security"
description: |-
  The resource `dynatrace_vulnerability_code` covers configuration for vulnerability analytics: monitoring rules for code-level vulnerabilities
---

# dynatrace_vulnerability_code (Resource)

-> This resource is excluded by default in the export utility since it requires the feature to be activated, please explicitly specify the resource to retrieve existing configuration.

-> This resource requires the API token scopes **Read security problems** (`securityProblems.read`) and **Write security problems** (`securityProblems.write`)

## Dynatrace Documentation

- Runtime Vulnerability Analytics - https://www.dynatrace.com/support/help/platform-modules/application-security/vulnerability-analytics

- Settings API - https://www.dynatrace.com/support/help/dynatrace-api/environment-api/settings (schemaId: `builtin:appsec.code-level-vulnerability-rule-settings`)

## Export Example Usage

- `terraform-provider-dynatrace -export dynatrace_vulnerability_code` downloads existing vulnerability analytics: monitoring rules for code-level vulnerabilities

The full documentation of the export feature is available [here](https://dt-url.net/h203qmc).

## Resource Example Usage

```terraform
resource "dynatrace_vulnerability_code" "#name#" {
  enabled = true
  metadata {
    comment = "#name#"
  }
  vulnerability_detection_control {
    monitoring_mode = "MONITORING_OFF"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `enabled` (Boolean) This setting is enabled (`true`) or disabled (`false`)
- `metadata` (Block List, Min: 1, Max: 1) Step 3: Leave comment (optional) (see [below for nested schema](#nestedblock--metadata))
- `vulnerability_detection_control` (Block List, Min: 1, Max: 1) Step 1: Select code-level vulnerability detection behavior (see [below for nested schema](#nestedblock--vulnerability_detection_control))

### Optional

- `criteria` (Block List, Max: 1, Deprecated) Define criteria (see [below for nested schema](#nestedblock--criteria))
- `insert_after` (String) Because this resource allows for ordering you may specify the ID of the resource instance that comes before this instance regarding order. If not specified when creating the setting will be added to the end of the list. If not specified during update the order will remain untouched
- `resource_attribute_conditions` (Block List, Max: 1) If you add more than one condition, note that all conditions must be true simultaneously for the rule to apply.

We provide suggestions for resource attribute keys and values based on what we currently see in your environment. You can also enter any value not currently seen in the list. Resource attributes come out of the box from the OneAgent, and you can set them up from [data enrichment](https://docs.dynatrace.com/docs/extend-dynatrace/extend-data). (see [below for nested schema](#nestedblock--resource_attribute_conditions))
- `rule_name` (String) Rule name

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

Required:

- `comment` (String) no documentation available


<a id="nestedblock--vulnerability_detection_control"></a>
### Nested Schema for `vulnerability_detection_control`

Required:

- `monitoring_mode` (String) Possible Values: `MONITORING_OFF`, `MONITORING_ON`


<a id="nestedblock--criteria"></a>
### Nested Schema for `criteria`

Optional:

- `process_group` (String) Process group


<a id="nestedblock--resource_attribute_conditions"></a>
### Nested Schema for `resource_attribute_conditions`

Required:

- `resource_attribute_condition` (Block List, Min: 1) (see [below for nested schema](#nestedblock--resource_attribute_conditions--resource_attribute_condition))

<a id="nestedblock--resource_attribute_conditions--resource_attribute_condition"></a>
### Nested Schema for `resource_attribute_conditions.resource_attribute_condition`

Required:

- `matcher` (String) Possible Values: `CONTAINS`, `DOES_NOT_CONTAIN`, `DOES_NOT_END_WITH`, `DOES_NOT_EXIST`, `DOES_NOT_START_WITH`, `ENDS_WITH`, `EQUALS`, `EXISTS`, `NOT_EQUALS`, `STARTS_WITH`
- `resource_attribute_key` (String) Resource attribute key

Optional:

- `resource_attribute_value` (String) Resource attribute value
 