resource "dynatrace_vulnerability_third_party_attr" "first-instance" {
  enabled      = false
  metadata {
    comment = ""
  }
  resource_attribute_conditions {
    resource_attribute_condition {
      matcher                  = "DOES_NOT_CONTAIN"
      resource_attribute_key   = "iis.app_pool.name"
      resource_attribute_value = "terraform"
    }
  }
  vulnerability_detection_control {
    monitoring_mode = "MONITORING_OFF"
  }
}

resource "dynatrace_vulnerability_third_party_attr" "second-instance" {
  enabled      = true
  insert_after = "${dynatrace_vulnerability_third_party_attr.first-instance.id}"
  rule_name    = "#name#-second"
  metadata {
    comment = "Leave a comment here"
  }
  resource_attribute_conditions {
    resource_attribute_condition {
      matcher                  = "EQUALS"
      resource_attribute_key   = "process.executable.path"
      resource_attribute_value = "/"
    }
    resource_attribute_condition {
      matcher                  = "CONTAINS"
      resource_attribute_key   = "process.executable.name"
      resource_attribute_value = "terraform"
    }
  }
  vulnerability_detection_control {
    monitoring_mode = "MONITORING_ON"
  }
}
