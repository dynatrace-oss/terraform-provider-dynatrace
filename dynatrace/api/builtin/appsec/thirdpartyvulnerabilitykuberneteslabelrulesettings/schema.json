{
	"allowedScopes": [
		"environment"
	],
	"description": "The global third-party vulnerability detection control defines the default for all Kubernetes hosts. To override the default, define custom monitoring rules here. Note that monitoring rules are ordered; the first matching rule applies.",
	"displayName": "Vulnerability Analytics: Kubernetes monitoring rules for third-party vulnerabilities",
	"documentation": "",
	"dynatrace": "1",
	"enums": {
		"KubernetesLabelValueMatcher": {
			"description": "",
			"displayName": "KubernetesLabelValueMatcher",
			"documentation": "",
			"items": [
				{
					"description": "The Kubernetes label value must be equal to the specified value.",
					"displayName": "equals",
					"value": "EQUALS"
				},
				{
					"description": "The Kubernetes label value must not be equal to the specified value.",
					"displayName": "does not equal",
					"value": "NOT_EQUALS"
				},
				{
					"description": "The Kubernetes label value must contain the specified value.",
					"displayName": "contains",
					"value": "CONTAINS"
				},
				{
					"description": "The Kubernetes label value must not contain the specified value.",
					"displayName": "does not contain",
					"value": "DOES_NOT_CONTAIN"
				},
				{
					"description": "The Kubernetes label value must start with the specified value.",
					"displayName": "starts with",
					"value": "STARTS_WITH"
				},
				{
					"description": "The Kubernetes label value must not start with the specified value.",
					"displayName": "does not start with",
					"value": "DOES_NOT_START_WITH"
				},
				{
					"description": "The Kubernetes label value must end with the specified value.",
					"displayName": "ends with",
					"value": "ENDS_WITH"
				},
				{
					"description": "The Kubernetes label value must not end with the specified value.",
					"displayName": "does not end with",
					"value": "DOES_NOT_END_WITH"
				},
				{
					"description": "The Kubernetes label must be defined (regardless of its value).",
					"displayName": "exists",
					"value": "EXISTS"
				},
				{
					"description": "The Kubernetes label must not be defined (regardless of its value).",
					"displayName": "does not exist",
					"value": "DOES_NOT_EXIST"
				}
			],
			"type": "enum"
		},
		"MonitoringModeTPV": {
			"description": "",
			"displayName": "MonitoringModeTPV",
			"documentation": "",
			"items": [
				{
					"description": "Third-party vulnerabilities will not be monitored",
					"displayName": "Do not monitor",
					"value": "MONITORING_OFF"
				},
				{
					"description": "Third-party vulnerabilities will be monitored",
					"displayName": "Monitor",
					"value": "MONITORING_ON"
				}
			],
			"type": "enum"
		}
	},
	"maxObjects": 1000,
	"metadata": {
		"addItemButton": "Add new rule"
	},
	"multiObject": true,
	"ordered": true,
	"properties": {
		"enabled": {
			"default": true,
			"description": "",
			"displayName": "Enabled",
			"documentation": "",
			"maxObjects": 1,
			"modificationPolicy": "DEFAULT",
			"nullable": false,
			"type": "boolean"
		},
		"kubernetesLabelConditions": {
			"description": "When you add multiple conditions, the rule applies if all conditions apply.\n\nIf you want the rule to apply only to a subset of your environment, provide the Kubernetes label that should be used to identify that part of the environment.",
			"displayName": "Step 2: Specify where the rule is applied (optional)",
			"documentation": "",
			"items": {
				"description": "",
				"displayName": "Condition",
				"documentation": "",
				"type": {
					"$ref": "#/types/KubernetesLabelCondition"
				}
			},
			"maxObjects": 100,
			"metadata": {
				"addItemButton": "Add new condition"
			},
			"minObjects": 0,
			"modificationPolicy": "DEFAULT",
			"nullable": false,
			"type": "list",
			"uiCustomization": {
				"table": {
					"columns": [
						{
							"builtinColumnRef": "summary",
							"displayName": "Condition"
						}
					]
				}
			}
		},
		"metadata": {
			"description": "",
			"displayName": "Step 3: Leave comment (optional)",
			"documentation": "",
			"maxObjects": 1,
			"modificationPolicy": "DEFAULT",
			"nullable": false,
			"type": {
				"$ref": "#/types/Metadata"
			}
		},
		"ruleName": {
			"constraints": [
				{
					"maxLength": 500,
					"minLength": 1,
					"type": "LENGTH"
				}
			],
			"description": "",
			"displayName": "Rule name",
			"documentation": "",
			"maxObjects": 1,
			"modificationPolicy": "DEFAULT",
			"nullable": true,
			"type": "text"
		},
		"vulnerabilityDetectionControl": {
			"description": "",
			"displayName": "Step 1: Select third-party vulnerability detection behavior",
			"documentation": "",
			"maxObjects": 1,
			"modificationPolicy": "DEFAULT",
			"nullable": false,
			"type": {
				"$ref": "#/types/VulnerabilityDetectionControl"
			}
		}
	},
	"schemaGroups": [
		"group:appsec",
		"group:appsec.third-party-monitoring-rules"
	],
	"schemaId": "builtin:appsec.third-party-vulnerability-kubernetes-label-rule-settings",
	"types": {
		"KubernetesLabelCondition": {
			"description": "",
			"displayName": "KubernetesLabelCondition",
			"documentation": "We provide suggestions for Kubernetes label keys and values based on what we currently see in your environment. You can also enter any value that isn't in the list. Key and value matches are case-sensitive.",
			"properties": {
				"kubernetesLabelKey": {
					"constraints": [
						{
							"maxLength": 500,
							"minLength": 1,
							"type": "LENGTH"
						}
					],
					"datasource": {
						"filterProperties": [],
						"fullContext": false,
						"identifier": "kubernetesLabelKeyDataSource",
						"resetValue": "NEVER",
						"useApiSearch": false,
						"validate": false
					},
					"default": "",
					"description": "",
					"displayName": "Kubernetes label key",
					"documentation": "",
					"maxObjects": 1,
					"metadata": {
						"autoSelectFirst": "disabled",
						"useCombobox": "enabled"
					},
					"modificationPolicy": "DEFAULT",
					"nullable": false,
					"subType": "datasource",
					"type": "text"
				},
				"kubernetesLabelValue": {
					"constraints": [
						{
							"maxLength": 500,
							"minLength": 1,
							"type": "LENGTH"
						}
					],
					"datasource": {
						"filterProperties": [
							"kubernetesLabelKey"
						],
						"fullContext": false,
						"identifier": "kubernetesLabelValueDataSource",
						"resetValue": "NEVER",
						"useApiSearch": false,
						"validate": false
					},
					"description": "",
					"displayName": "Kubernetes label value",
					"documentation": "",
					"maxObjects": 1,
					"metadata": {
						"autoSelectFirst": "disabled",
						"useCombobox": "enabled"
					},
					"modificationPolicy": "DEFAULT",
					"nullable": true,
					"precondition": {
						"precondition": {
							"expectedValues": [
								"EXISTS",
								"DOES_NOT_EXIST"
							],
							"property": "matcher",
							"type": "IN"
						},
						"type": "NOT"
					},
					"subType": "datasource",
					"type": "text"
				},
				"matcher": {
					"default": "EQUALS",
					"description": "",
					"displayName": "Matcher",
					"documentation": "",
					"maxObjects": 1,
					"metadata": {
						"sortItems": "disabled"
					},
					"modificationPolicy": "DEFAULT",
					"nullable": false,
					"type": {
						"$ref": "#/enums/KubernetesLabelValueMatcher"
					}
				}
			},
			"summaryPattern": "{matcher|enumValue, select, EXISTS {\"{kubernetesLabelKey}\" {matcher}} DOES_NOT_EXIST {\"{kubernetesLabelKey}\" {matcher}} other {\"{kubernetesLabelKey}\" {matcher} \"{kubernetesLabelValue}\"}}",
			"type": "object",
			"version": "0",
			"versionInfo": ""
		},
		"Metadata": {
			"description": "",
			"displayName": "Metadata",
			"documentation": "",
			"properties": {
				"comment": {
					"constraints": [
						{
							"maxLength": 5000,
							"type": "LENGTH"
						}
					],
					"default": "",
					"description": "",
					"displayName": "Comment",
					"documentation": "",
					"maxObjects": 1,
					"modificationPolicy": "DEFAULT",
					"nullable": false,
					"subType": "multiline",
					"type": "text"
				}
			},
			"summaryPattern": "",
			"type": "object",
			"version": "0",
			"versionInfo": ""
		},
		"VulnerabilityDetectionControl": {
			"description": "",
			"displayName": "VulnerabilityDetectionControl",
			"documentation": "",
			"properties": {
				"monitoringMode": {
					"default": "MONITORING_OFF",
					"description": "",
					"displayName": "Third-party vulnerability control",
					"documentation": "",
					"maxObjects": 1,
					"metadata": {
						"sortItems": "disabled"
					},
					"modificationPolicy": "DEFAULT",
					"nullable": false,
					"type": {
						"$ref": "#/enums/MonitoringModeTPV"
					}
				}
			},
			"summaryPattern": "",
			"type": "object",
			"version": "0",
			"versionInfo": ""
		}
	},
	"uiCustomization": {
		"table": {
			"columns": [
				{
					"builtinColumnRef": "summary",
					"displayName": "Rule"
				}
			]
		}
	},
	"version": "1"
}